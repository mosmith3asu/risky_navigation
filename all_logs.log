Using device: cuda
Batch size: 512 (optimized for RTX 4090)
Max epochs: 200 (with early stopping)
Random search enabled for: ['Transformer', 'Bayesian', 'VAE', 'Linear']
Trials per algorithm: 50
Total configurations to test: 200

All algorithms will test sequence lengths: [1, 5, 10]
  - sequence_len=1: Single previous action (baseline)
  - sequence_len>1: Temporal sequences (history-based prediction)
  ============================================================
GPU OPTIMIZATIONS ENABLED FOR RTX 4090
============================================================
✓ Batch size: 512
✓ TF32 matmul: Enabled
✓ cuDNN benchmark: Enabled
✓ Mixed precision (AMP): Enabled
✓ CUDA version: 12.4
✓ GPU: NVIDIA GeForce RTX 4090
✓ VRAM: 23.5 GB
============================================================
Collecting new dataset with sequence_len=5...
Precomuting visibility graph...
	| Recomputing...
	| Creating grid...
	| Building graph...
	| Computing distances grid...
	| saving to cache...
	| finished.
Collecting experience: 100%|██████████| 1000/1000 [44:29<00:00,  2.67s/it]
Collected 33007 sequence samples from 1000 episodes
Success rate: 0.00%
✓ Saved dataset to expert_dataset_seq5.pickle

Dataset Summary:
  Total sequence samples: 33007
  State sequences shape: (33007, 5, 8)  # (samples, seq_len, state_dim)
  Action sequences shape: (33007, 5, 2)  # (samples, seq_len, action_dim)
  Target actions shape: (33007, 2)  # (samples, action_dim)
  Goals shape: (33007, 2)  # (samples, 2)
  Environment & Data Configuration:
  STATE_DIM = 8
  ACTION_DIM = 2
  GOAL_DIM = 2
  Total samples = 33007
  Sequence length used = 5
  State space: (8,)
  Action space: (2,)
============================================================
RANDOM SEARCH TRAINING - ALL ALGORITHMS
============================================================
Data split: 26405 train, 6602 val
Batch size: 512
Max epochs: 200
Random trials per algorithm: 50

Note: Data collected with sequence_len=5
Random search will test different sequence_len by slicing/padding sequences

============================================================
Random Search: Linear
============================================================
Testing 50 random configurations for Linear...
  [1/50] Testing {'sequence_len': 10, 'lr': 0.0006935288092599838}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [2/50] Testing {'sequence_len': 1, 'lr': 0.0002552476880477854}...
    ✓ New best: 0.020501
  [3/50] Testing {'sequence_len': 5, 'lr': 0.0005856030068660645}...
    ✓ New best: 0.009571
  [4/50] Testing {'sequence_len': 1, 'lr': 0.00020816884047349468}...
  [5/50] Testing {'sequence_len': 1, 'lr': 0.00046379421969489467}...
  [6/50] Testing {'sequence_len': 5, 'lr': 0.00019554388946130992}...
  [7/50] Testing {'sequence_len': 1, 'lr': 0.00014059746071491913}...
  [8/50] Testing {'sequence_len': 5, 'lr': 0.00042120519680761644}...
    ✓ New best: 0.009467
  [9/50] Testing {'sequence_len': 5, 'lr': 0.00037514330905119336}...
  [10/50] Testing {'sequence_len': 5, 'lr': 0.00042474210928741975}...
    ✓ New best: 0.009436
  [11/50] Testing {'sequence_len': 5, 'lr': 0.00033120587295331944}...
  [12/50] Testing {'sequence_len': 5, 'lr': 0.00017777039497589861}...
  [13/50] Testing {'sequence_len': 5, 'lr': 0.0002722049156767145}...
  [14/50] Testing {'sequence_len': 1, 'lr': 0.0004200874767695074}...
  [15/50] Testing {'sequence_len': 1, 'lr': 0.0008716445192992139}...
  [16/50] Testing {'sequence_len': 5, 'lr': 0.00010467419502692027}...
  [17/50] Testing {'sequence_len': 5, 'lr': 0.00018356204541147123}...
  [18/50] Testing {'sequence_len': 5, 'lr': 0.0001774740267858649}...
  [19/50] Testing {'sequence_len': 10, 'lr': 0.00016005302222895764}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [20/50] Testing {'sequence_len': 10, 'lr': 0.0008045421184368852}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [21/50] Testing {'sequence_len': 10, 'lr': 0.00011797056980224045}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [22/50] Testing {'sequence_len': 5, 'lr': 0.000400480414473054}...
  [23/50] Testing {'sequence_len': 5, 'lr': 0.0008079276950216151}...
    ✓ New best: 0.009308
  [24/50] Testing {'sequence_len': 5, 'lr': 0.0009954110043036402}...
  [25/50] Testing {'sequence_len': 10, 'lr': 0.00029159812945802596}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [26/50] Testing {'sequence_len': 1, 'lr': 0.0005398750077877903}...
  [27/50] Testing {'sequence_len': 10, 'lr': 0.00014181421862585256}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [28/50] Testing {'sequence_len': 5, 'lr': 0.00010798060343514225}...
  [29/50] Testing {'sequence_len': 5, 'lr': 0.00026747335683905603}...
  [30/50] Testing {'sequence_len': 5, 'lr': 0.0005338796005208398}...
  [31/50] Testing {'sequence_len': 10, 'lr': 0.00017781194706428346}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [32/50] Testing {'sequence_len': 5, 'lr': 0.0006113398719693712}...
  [33/50] Testing {'sequence_len': 1, 'lr': 0.0005891084003385109}...
  [34/50] Testing {'sequence_len': 10, 'lr': 0.00016115866020983635}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [35/50] Testing {'sequence_len': 10, 'lr': 0.00036786080802248786}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [36/50] Testing {'sequence_len': 10, 'lr': 0.00022511423198061262}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [37/50] Testing {'sequence_len': 10, 'lr': 0.00011936024060870402}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [38/50] Testing {'sequence_len': 10, 'lr': 0.00021985408685145936}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [39/50] Testing {'sequence_len': 5, 'lr': 0.00011560327620267797}...
  [40/50] Testing {'sequence_len': 10, 'lr': 0.00012810977828942334}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [41/50] Testing {'sequence_len': 5, 'lr': 0.00021406921416897845}...
  [42/50] Testing {'sequence_len': 10, 'lr': 0.000801208005570928}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [43/50] Testing {'sequence_len': 5, 'lr': 0.0005293505882977476}...
  [44/50] Testing {'sequence_len': 10, 'lr': 0.0002946062697170232}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [45/50] Testing {'sequence_len': 5, 'lr': 0.00014333143519880444}...
  [46/50] Testing {'sequence_len': 5, 'lr': 0.00012329011797979916}...
  [47/50] Testing {'sequence_len': 10, 'lr': 0.0004851172443400204}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [48/50] Testing {'sequence_len': 5, 'lr': 0.00010802653995436633}...
  [49/50] Testing {'sequence_len': 10, 'lr': 0.00010062821862793696}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)
  [50/50] Testing {'sequence_len': 10, 'lr': 0.00033785011983189836}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x2)

Linear Best Config: {'sequence_len': 5, 'lr': 0.0008079276950216151}
Linear Best Val Loss: 0.009308
Linear Train Time: 4.80s

============================================================
Random Search: Transformer
============================================================
Testing 50 random configurations for Transformer...
  [1/50] Testing {'d_model': 48, 'nhead': 8, 'num_layers': 2, 'dropout': 0.08598350060651597, 'sequence_len': 10, 'lr': 0.0002231846636479598}...
    ✓ New best: 0.000033
  [2/50] Testing {'d_model': 72, 'nhead': 4, 'num_layers': 4, 'dropout': 0.13582572037873583, 'sequence_len': 10, 'lr': 0.00010217822437424176}...
  [3/50] Testing {'d_model': 52, 'nhead': 4, 'num_layers': 4, 'dropout': 0.07903087739979564, 'sequence_len': 1, 'lr': 0.0007573288481568313}...
  [4/50] Testing {'d_model': 80, 'nhead': 4, 'num_layers': 2, 'dropout': 0.07300749692443545, 'sequence_len': 10, 'lr': 0.0003114974954568882}...
    ✓ New best: 0.000016
  [5/50] Testing {'d_model': 52, 'nhead': 4, 'num_layers': 3, 'dropout': 0.038126046648897766, 'sequence_len': 1, 'lr': 0.00011330930358933783}...
  [6/50] Testing {'d_model': 48, 'nhead': 4, 'num_layers': 4, 'dropout': 0.07853204491031969, 'sequence_len': 1, 'lr': 0.0009234425242503276}...
  [7/50] Testing {'d_model': 124, 'nhead': 4, 'num_layers': 4, 'dropout': 0.12181208309668082, 'sequence_len': 1, 'lr': 0.0008322365357897948}...
  [8/50] Testing {'d_model': 80, 'nhead': 4, 'num_layers': 4, 'dropout': 0.030305990685873543, 'sequence_len': 5, 'lr': 0.0004344164280530046}...
    ✓ New best: 0.000010
  [9/50] Testing {'d_model': 32, 'nhead': 8, 'num_layers': 2, 'dropout': 0.04938574833658121, 'sequence_len': 10, 'lr': 0.000521441697654624}...
  [10/50] Testing {'d_model': 56, 'nhead': 8, 'num_layers': 2, 'dropout': 0.14160848795590802, 'sequence_len': 1, 'lr': 0.0007978404331493714}...
  [11/50] Testing {'d_model': 32, 'nhead': 4, 'num_layers': 3, 'dropout': 0.017848629918184034, 'sequence_len': 10, 'lr': 0.0005178906002933511}...
    ✓ New best: 0.000008
  [12/50] Testing {'d_model': 96, 'nhead': 8, 'num_layers': 2, 'dropout': 0.15537055631338148, 'sequence_len': 10, 'lr': 0.0005153762646156614}...
  [13/50] Testing {'d_model': 108, 'nhead': 4, 'num_layers': 3, 'dropout': 0.02502394493805933, 'sequence_len': 5, 'lr': 0.0001100124551531905}...
  [14/50] Testing {'d_model': 116, 'nhead': 4, 'num_layers': 2, 'dropout': 0.1380082103446233, 'sequence_len': 5, 'lr': 0.0007598494938175766}...
  [15/50] Testing {'d_model': 48, 'nhead': 4, 'num_layers': 2, 'dropout': 0.1580036458059485, 'sequence_len': 5, 'lr': 0.0003997191209533646}...
  [16/50] Testing {'d_model': 88, 'nhead': 8, 'num_layers': 4, 'dropout': 0.051226458826204115, 'sequence_len': 1, 'lr': 0.0005933120344608125}...
  [17/50] Testing {'d_model': 40, 'nhead': 4, 'num_layers': 4, 'dropout': 0.028151887349851835, 'sequence_len': 5, 'lr': 0.0007173320782984141}...
  [18/50] Testing {'d_model': 108, 'nhead': 4, 'num_layers': 2, 'dropout': 0.04136824103615566, 'sequence_len': 5, 'lr': 0.0006059724043870811}...
  [19/50] Testing {'d_model': 40, 'nhead': 4, 'num_layers': 3, 'dropout': 0.10310254333536054, 'sequence_len': 10, 'lr': 0.00019607701107848366}...
  [20/50] Testing {'d_model': 40, 'nhead': 8, 'num_layers': 4, 'dropout': 0.17526845888665402, 'sequence_len': 1, 'lr': 0.0005534331319462633}...
  [21/50] Testing {'d_model': 80, 'nhead': 8, 'num_layers': 2, 'dropout': 0.05364744209520276, 'sequence_len': 10, 'lr': 0.00020204779932522386}...
  [22/50] Testing {'d_model': 72, 'nhead': 4, 'num_layers': 3, 'dropout': 0.17783870760520823, 'sequence_len': 10, 'lr': 0.0005207920545099213}...
  [23/50] Testing {'d_model': 72, 'nhead': 4, 'num_layers': 3, 'dropout': 0.19733431882381583, 'sequence_len': 10, 'lr': 0.0004008315364372888}...
  [24/50] Testing {'d_model': 76, 'nhead': 4, 'num_layers': 2, 'dropout': 0.11389118310712427, 'sequence_len': 10, 'lr': 0.0006562041857303613}...
  [25/50] Testing {'d_model': 124, 'nhead': 4, 'num_layers': 2, 'dropout': 0.04700121412106502, 'sequence_len': 10, 'lr': 0.00013894771055957371}...
  [26/50] Testing {'d_model': 48, 'nhead': 8, 'num_layers': 4, 'dropout': 0.0034890717528953674, 'sequence_len': 5, 'lr': 0.00046418537891054616}...
    ✓ New best: 0.000007
  [27/50] Testing {'d_model': 80, 'nhead': 8, 'num_layers': 3, 'dropout': 0.06041004821035816, 'sequence_len': 10, 'lr': 0.00015881431520407924}...
  [28/50] Testing {'d_model': 32, 'nhead': 8, 'num_layers': 4, 'dropout': 0.030157370151863306, 'sequence_len': 1, 'lr': 0.000785953273684516}...
  [29/50] Testing {'d_model': 96, 'nhead': 8, 'num_layers': 4, 'dropout': 0.14765429170069846, 'sequence_len': 5, 'lr': 0.0008878873819166909}...
  [30/50] Testing {'d_model': 48, 'nhead': 4, 'num_layers': 2, 'dropout': 0.060717556713445676, 'sequence_len': 10, 'lr': 0.00018370210401004734}...
  [31/50] Testing {'d_model': 112, 'nhead': 4, 'num_layers': 2, 'dropout': 0.03912909905693971, 'sequence_len': 10, 'lr': 0.00011226124421943709}...
  [32/50] Testing {'d_model': 104, 'nhead': 8, 'num_layers': 4, 'dropout': 0.1762355622143964, 'sequence_len': 5, 'lr': 0.000730353726746049}...
  [33/50] Testing {'d_model': 40, 'nhead': 4, 'num_layers': 2, 'dropout': 0.016452443790940796, 'sequence_len': 5, 'lr': 0.00040158323811675375}...
  [34/50] Testing {'d_model': 56, 'nhead': 8, 'num_layers': 2, 'dropout': 0.01208840744315176, 'sequence_len': 1, 'lr': 0.0001155459545648878}...
  [35/50] Testing {'d_model': 72, 'nhead': 8, 'num_layers': 4, 'dropout': 0.07754844178047443, 'sequence_len': 10, 'lr': 0.000711516998094881}...
  [36/50] Testing {'d_model': 88, 'nhead': 4, 'num_layers': 4, 'dropout': 0.11836604575967456, 'sequence_len': 1, 'lr': 0.0003751982529486417}...
  [37/50] Testing {'d_model': 72, 'nhead': 4, 'num_layers': 3, 'dropout': 0.06534923108541095, 'sequence_len': 5, 'lr': 0.00010187120374730786}...
  [38/50] Testing {'d_model': 96, 'nhead': 8, 'num_layers': 3, 'dropout': 0.1298532333751433, 'sequence_len': 10, 'lr': 0.0002103727902524719}...
  [39/50] Testing {'d_model': 80, 'nhead': 8, 'num_layers': 2, 'dropout': 0.10899270302974906, 'sequence_len': 5, 'lr': 0.0002285873644818471}...
  [40/50] Testing {'d_model': 108, 'nhead': 4, 'num_layers': 2, 'dropout': 0.19301147747065017, 'sequence_len': 10, 'lr': 0.00015489583538781237}...
  [41/50] Testing {'d_model': 112, 'nhead': 8, 'num_layers': 2, 'dropout': 0.03882145336115335, 'sequence_len': 5, 'lr': 0.00014095462271185676}...
    ✓ New best: 0.000006
  [42/50] Testing {'d_model': 120, 'nhead': 8, 'num_layers': 3, 'dropout': 0.11946188422144421, 'sequence_len': 1, 'lr': 0.0001227998315694776}...
  [43/50] Testing {'d_model': 72, 'nhead': 8, 'num_layers': 2, 'dropout': 0.07765586944740527, 'sequence_len': 1, 'lr': 0.00015660367841832873}...
  [44/50] Testing {'d_model': 48, 'nhead': 8, 'num_layers': 4, 'dropout': 0.17617854192730675, 'sequence_len': 5, 'lr': 0.0003445963551718067}...
  [45/50] Testing {'d_model': 120, 'nhead': 4, 'num_layers': 4, 'dropout': 0.18622023920681377, 'sequence_len': 1, 'lr': 0.0009083844167452589}...
  [46/50] Testing {'d_model': 72, 'nhead': 8, 'num_layers': 2, 'dropout': 0.16951444338899424, 'sequence_len': 10, 'lr': 0.0007549743318437238}...
  [47/50] Testing {'d_model': 32, 'nhead': 4, 'num_layers': 4, 'dropout': 0.04781913964460023, 'sequence_len': 5, 'lr': 0.00022292401532106836}...
  [48/50] Testing {'d_model': 112, 'nhead': 4, 'num_layers': 4, 'dropout': 0.02877055846092773, 'sequence_len': 10, 'lr': 0.0002241026146506497}...
  [49/50] Testing {'d_model': 88, 'nhead': 8, 'num_layers': 3, 'dropout': 0.17497068643256614, 'sequence_len': 10, 'lr': 0.0008243726497706953}...
  [50/50] Testing {'d_model': 32, 'nhead': 8, 'num_layers': 3, 'dropout': 0.13984198409060616, 'sequence_len': 5, 'lr': 0.00010118993462610171}...

Transformer Best Config: {'d_model': 112, 'nhead': 8, 'num_layers': 2, 'dropout': 0.03882145336115335, 'sequence_len': 5, 'lr': 0.00014095462271185676}
Transformer Best Val Loss: 0.000006
Transformer Train Time: 10.71s

============================================================
Random Search: Bayesian
============================================================
Testing 50 random configurations for Bayesian...
  [1/50] Testing {'hidden_dim': 247, 'prior_std': 1.7748769588143136, 'kl_weight': 0.00036256527741779297, 'sequence_len': 1, 'lr': 0.00015795350375912847}...
    ✓ New best: 0.137443
  [2/50] Testing {'hidden_dim': 93, 'prior_std': 0.8517860550499234, 'kl_weight': 0.0005786870762034411, 'sequence_len': 1, 'lr': 0.000617827149370235}...
    ✓ New best: 0.045684
  [3/50] Testing {'hidden_dim': 200, 'prior_std': 1.4089062238188164, 'kl_weight': 0.00017703412734753268, 'sequence_len': 1, 'lr': 0.0005754109544483067}...
  [4/50] Testing {'hidden_dim': 229, 'prior_std': 1.8150565631369302, 'kl_weight': 1.017041707893768e-05, 'sequence_len': 5, 'lr': 0.00026137119617316396}...
  [5/50] Testing {'hidden_dim': 168, 'prior_std': 1.4656191520647308, 'kl_weight': 6.65965460254276e-05, 'sequence_len': 1, 'lr': 0.00015732202273845364}...
  [6/50] Testing {'hidden_dim': 93, 'prior_std': 0.5782109329683462, 'kl_weight': 3.1329039748957196e-05, 'sequence_len': 5, 'lr': 0.00034974464347150024}...
  [7/50] Testing {'hidden_dim': 154, 'prior_std': 1.2228983730777991, 'kl_weight': 0.00032294944132242424, 'sequence_len': 10, 'lr': 0.00022308021944122356}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x154)
  [8/50] Testing {'hidden_dim': 88, 'prior_std': 0.8318192862151773, 'kl_weight': 2.391331355220736e-05, 'sequence_len': 10, 'lr': 0.0005294766973530316}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x88)
  [9/50] Testing {'hidden_dim': 256, 'prior_std': 1.4934984414885335, 'kl_weight': 0.00012056323360720352, 'sequence_len': 10, 'lr': 0.00011674947515531354}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x256)
  [10/50] Testing {'hidden_dim': 143, 'prior_std': 1.4372718447320592, 'kl_weight': 3.3093251148319165e-05, 'sequence_len': 10, 'lr': 0.000545681168114882}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x143)
  [11/50] Testing {'hidden_dim': 167, 'prior_std': 1.6357250457925612, 'kl_weight': 0.0003806641675810628, 'sequence_len': 1, 'lr': 0.00031274157572473916}...
  [12/50] Testing {'hidden_dim': 101, 'prior_std': 1.031221759910456, 'kl_weight': 3.3393979792897664e-05, 'sequence_len': 1, 'lr': 0.0004998069783129187}...
  [13/50] Testing {'hidden_dim': 91, 'prior_std': 1.8243064563800557, 'kl_weight': 0.0003870121373638783, 'sequence_len': 10, 'lr': 0.000954103250537093}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x91)
  [14/50] Testing {'hidden_dim': 184, 'prior_std': 0.559042263837664, 'kl_weight': 5.125126452371425e-05, 'sequence_len': 1, 'lr': 0.0003764330673533697}...
    ✓ New best: 0.035634
  [15/50] Testing {'hidden_dim': 162, 'prior_std': 1.768536124250366, 'kl_weight': 3.867841487197505e-05, 'sequence_len': 10, 'lr': 0.0001880616398794947}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x162)
  [16/50] Testing {'hidden_dim': 236, 'prior_std': 1.9169499295864925, 'kl_weight': 0.0009066569320696465, 'sequence_len': 1, 'lr': 0.00016937684366143867}...
  [17/50] Testing {'hidden_dim': 245, 'prior_std': 1.6568342416222617, 'kl_weight': 0.000532121823535736, 'sequence_len': 5, 'lr': 0.000442068449561502}...
  [18/50] Testing {'hidden_dim': 211, 'prior_std': 1.6664530693522317, 'kl_weight': 0.0002375555693820614, 'sequence_len': 5, 'lr': 0.00014711941430970246}...
  [19/50] Testing {'hidden_dim': 203, 'prior_std': 1.0586906446876574, 'kl_weight': 5.445363455451418e-05, 'sequence_len': 1, 'lr': 0.0002128005592392828}...
  [20/50] Testing {'hidden_dim': 163, 'prior_std': 0.8352876011707031, 'kl_weight': 1.6728584561781494e-05, 'sequence_len': 1, 'lr': 0.00018190913531070655}...
  [21/50] Testing {'hidden_dim': 179, 'prior_std': 0.5795603198701367, 'kl_weight': 0.0004642964964309873, 'sequence_len': 1, 'lr': 0.0002191399764936594}...
  [22/50] Testing {'hidden_dim': 180, 'prior_std': 1.6637767010687776, 'kl_weight': 0.0001123578414388705, 'sequence_len': 5, 'lr': 0.00010432006328724172}...
  [23/50] Testing {'hidden_dim': 226, 'prior_std': 1.0746999855232038, 'kl_weight': 5.023430540709166e-05, 'sequence_len': 1, 'lr': 0.00010216319787157113}...
  [24/50] Testing {'hidden_dim': 142, 'prior_std': 1.19852333565667, 'kl_weight': 0.00011347952233524782, 'sequence_len': 5, 'lr': 0.00023127182885385351}...
  [25/50] Testing {'hidden_dim': 177, 'prior_std': 0.7708607075539671, 'kl_weight': 9.611316499245933e-05, 'sequence_len': 10, 'lr': 0.0002108453989860467}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x177)
  [26/50] Testing {'hidden_dim': 200, 'prior_std': 1.9122694436977619, 'kl_weight': 2.0905662097664964e-05, 'sequence_len': 5, 'lr': 0.0005719877491626298}...
  [27/50] Testing {'hidden_dim': 131, 'prior_std': 0.6707553622326785, 'kl_weight': 0.00020225323719522497, 'sequence_len': 5, 'lr': 0.0003479460803893234}...
  [28/50] Testing {'hidden_dim': 68, 'prior_std': 0.5578692035828776, 'kl_weight': 0.00018003594255285187, 'sequence_len': 5, 'lr': 0.00048226858374870616}...
  [29/50] Testing {'hidden_dim': 173, 'prior_std': 1.9567631935904444, 'kl_weight': 0.0002448910561120636, 'sequence_len': 1, 'lr': 0.00023168367258023716}...
  [30/50] Testing {'hidden_dim': 182, 'prior_std': 1.3157186630529032, 'kl_weight': 0.0006040830351991211, 'sequence_len': 10, 'lr': 0.00022364800818220907}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x182)
  [31/50] Testing {'hidden_dim': 114, 'prior_std': 1.318940333056763, 'kl_weight': 3.658020611915237e-05, 'sequence_len': 1, 'lr': 0.0005108549107913714}...
  [32/50] Testing {'hidden_dim': 167, 'prior_std': 1.8820150172493326, 'kl_weight': 4.656847743940963e-05, 'sequence_len': 1, 'lr': 0.00022957560728488426}...
  [33/50] Testing {'hidden_dim': 209, 'prior_std': 1.6945071295535206, 'kl_weight': 0.0001349014586366961, 'sequence_len': 10, 'lr': 0.0005749490478912366}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x209)
  [34/50] Testing {'hidden_dim': 103, 'prior_std': 1.9314742932096158, 'kl_weight': 0.0009454760763692516, 'sequence_len': 1, 'lr': 0.00010366437476563305}...
  [35/50] Testing {'hidden_dim': 207, 'prior_std': 1.7145988798304714, 'kl_weight': 6.532043091521398e-05, 'sequence_len': 10, 'lr': 0.00010783168192336428}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x207)
  [36/50] Testing {'hidden_dim': 175, 'prior_std': 1.5061111067361825, 'kl_weight': 0.0005984608268674142, 'sequence_len': 10, 'lr': 0.0009617729480387839}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x175)
  [37/50] Testing {'hidden_dim': 80, 'prior_std': 1.6031506916145213, 'kl_weight': 5.171237713745518e-05, 'sequence_len': 1, 'lr': 0.00032109956059909165}...
  [38/50] Testing {'hidden_dim': 177, 'prior_std': 1.6618584502858456, 'kl_weight': 9.75507993982434e-05, 'sequence_len': 5, 'lr': 0.00042842649225030837}...
  [39/50] Testing {'hidden_dim': 161, 'prior_std': 1.549866131927112, 'kl_weight': 0.00020897519182850867, 'sequence_len': 5, 'lr': 0.00019608835998761553}...
  [40/50] Testing {'hidden_dim': 160, 'prior_std': 0.9020053534591128, 'kl_weight': 2.3049082652813358e-05, 'sequence_len': 10, 'lr': 0.00023876131847466752}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x160)
  [41/50] Testing {'hidden_dim': 128, 'prior_std': 1.6120857395066268, 'kl_weight': 1.303093546576391e-05, 'sequence_len': 10, 'lr': 0.0002541168538540765}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x128)
  [42/50] Testing {'hidden_dim': 242, 'prior_std': 0.5092041150388276, 'kl_weight': 0.00021990565192171445, 'sequence_len': 1, 'lr': 0.00031813218370075025}...
  [43/50] Testing {'hidden_dim': 144, 'prior_std': 1.7009531717981037, 'kl_weight': 0.00037482881102216345, 'sequence_len': 1, 'lr': 0.0001492085220167099}...
  [44/50] Testing {'hidden_dim': 222, 'prior_std': 1.5020716711467328, 'kl_weight': 0.0008666500624350958, 'sequence_len': 5, 'lr': 0.00024933004921546577}...
  [45/50] Testing {'hidden_dim': 236, 'prior_std': 1.1349378646673205, 'kl_weight': 0.0006490841781469753, 'sequence_len': 1, 'lr': 0.0004740559362320685}...
  [46/50] Testing {'hidden_dim': 237, 'prior_std': 1.3532349458013389, 'kl_weight': 9.684230643330305e-05, 'sequence_len': 10, 'lr': 0.00038096991039955527}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x237)
  [47/50] Testing {'hidden_dim': 238, 'prior_std': 1.7046342001543417, 'kl_weight': 3.766734006445359e-05, 'sequence_len': 1, 'lr': 0.000855014858555364}...
  [48/50] Testing {'hidden_dim': 90, 'prior_std': 1.8052048995939698, 'kl_weight': 1.174487003736045e-05, 'sequence_len': 5, 'lr': 0.00023629448883191831}...
  [49/50] Testing {'hidden_dim': 106, 'prior_std': 1.1432315690539363, 'kl_weight': 0.00017919146412255382, 'sequence_len': 1, 'lr': 0.0003563674390623374}...
  [50/50] Testing {'hidden_dim': 118, 'prior_std': 0.6506480581370073, 'kl_weight': 2.271588143155603e-05, 'sequence_len': 10, 'lr': 0.00019277638310542016}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x118)

Bayesian Best Config: {'hidden_dim': 184, 'prior_std': 0.559042263837664, 'kl_weight': 5.125126452371425e-05, 'sequence_len': 1, 'lr': 0.0003764330673533697}
Bayesian Best Val Loss: 0.035634
Bayesian Train Time: 2.42s

============================================================
Random Search: VAE
============================================================
Testing 50 random configurations for VAE...
  [1/50] Testing {'latent_dim': 18, 'hidden_dim': 240, 'beta': 0.5189790725634912, 'sequence_len': 1, 'lr': 0.0001277618947538782}...
    ✓ New best: 0.074714
  [2/50] Testing {'latent_dim': 21, 'hidden_dim': 110, 'beta': 0.6496334184010276, 'sequence_len': 5, 'lr': 0.0002106420361110957}...
    ✓ New best: 0.068870
  [3/50] Testing {'latent_dim': 17, 'hidden_dim': 67, 'beta': 1.8741000343793743, 'sequence_len': 10, 'lr': 0.0004147775050126256}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x67)
  [4/50] Testing {'latent_dim': 19, 'hidden_dim': 224, 'beta': 1.7518464857384362, 'sequence_len': 5, 'lr': 0.0005175165974465206}...
  [5/50] Testing {'latent_dim': 47, 'hidden_dim': 255, 'beta': 0.9702803175574735, 'sequence_len': 1, 'lr': 0.0001623598142302138}...
  [6/50] Testing {'latent_dim': 24, 'hidden_dim': 146, 'beta': 1.8281868823078247, 'sequence_len': 10, 'lr': 0.00010458924732465232}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x146)
  [7/50] Testing {'latent_dim': 59, 'hidden_dim': 245, 'beta': 1.1130358263651021, 'sequence_len': 10, 'lr': 0.0003442170425697069}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x245)
  [8/50] Testing {'latent_dim': 38, 'hidden_dim': 168, 'beta': 1.0532102716854066, 'sequence_len': 5, 'lr': 0.0001838553145260521}...
  [9/50] Testing {'latent_dim': 54, 'hidden_dim': 97, 'beta': 1.14848908586968, 'sequence_len': 10, 'lr': 0.0004542691081381255}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x97)
  [10/50] Testing {'latent_dim': 54, 'hidden_dim': 136, 'beta': 1.9351637519887315, 'sequence_len': 5, 'lr': 0.00024382453251282582}...
  [11/50] Testing {'latent_dim': 46, 'hidden_dim': 130, 'beta': 0.6575808069003788, 'sequence_len': 10, 'lr': 0.0004708034212528788}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x130)
  [12/50] Testing {'latent_dim': 41, 'hidden_dim': 103, 'beta': 1.1037888959002613, 'sequence_len': 10, 'lr': 0.00011202252585463396}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x103)
  [13/50] Testing {'latent_dim': 38, 'hidden_dim': 115, 'beta': 0.9866416200230506, 'sequence_len': 1, 'lr': 0.0002703005573436256}...
  [14/50] Testing {'latent_dim': 29, 'hidden_dim': 199, 'beta': 1.7053960261499446, 'sequence_len': 10, 'lr': 0.00035474072317463246}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x199)
  [15/50] Testing {'latent_dim': 62, 'hidden_dim': 65, 'beta': 1.2440256222731343, 'sequence_len': 10, 'lr': 0.0007928924591692796}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x65)
  [16/50] Testing {'latent_dim': 41, 'hidden_dim': 128, 'beta': 1.6964231585712413, 'sequence_len': 5, 'lr': 0.00012311635245709754}...
  [17/50] Testing {'latent_dim': 47, 'hidden_dim': 100, 'beta': 1.35728719591221, 'sequence_len': 1, 'lr': 0.0003016550113556583}...
  [18/50] Testing {'latent_dim': 23, 'hidden_dim': 79, 'beta': 1.8948214037253617, 'sequence_len': 5, 'lr': 0.000907686943582833}...
  [19/50] Testing {'latent_dim': 63, 'hidden_dim': 157, 'beta': 1.7085486342758223, 'sequence_len': 10, 'lr': 0.00014491417061558077}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x157)
  [20/50] Testing {'latent_dim': 22, 'hidden_dim': 126, 'beta': 1.9535565545943023, 'sequence_len': 10, 'lr': 0.0006204667052487157}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x126)
  [21/50] Testing {'latent_dim': 57, 'hidden_dim': 216, 'beta': 0.5656381460186966, 'sequence_len': 1, 'lr': 0.00016654458405045074}...
  [22/50] Testing {'latent_dim': 51, 'hidden_dim': 255, 'beta': 1.1395203799768856, 'sequence_len': 5, 'lr': 0.00013745006163212693}...
  [23/50] Testing {'latent_dim': 55, 'hidden_dim': 225, 'beta': 1.1452688948608656, 'sequence_len': 10, 'lr': 0.00010340176223954666}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x225)
  [24/50] Testing {'latent_dim': 22, 'hidden_dim': 207, 'beta': 1.2260756319133594, 'sequence_len': 10, 'lr': 0.0005249998421180867}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x207)
  [25/50] Testing {'latent_dim': 57, 'hidden_dim': 149, 'beta': 1.2544038215892344, 'sequence_len': 1, 'lr': 0.00018715187123501787}...
  [26/50] Testing {'latent_dim': 19, 'hidden_dim': 91, 'beta': 0.8995471592361132, 'sequence_len': 5, 'lr': 0.00010390219911149144}...
  [27/50] Testing {'latent_dim': 43, 'hidden_dim': 126, 'beta': 1.9809998135304043, 'sequence_len': 1, 'lr': 0.0009595228498941472}...
  [28/50] Testing {'latent_dim': 51, 'hidden_dim': 127, 'beta': 1.885861457694094, 'sequence_len': 10, 'lr': 0.00019956285516092178}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x127)
  [29/50] Testing {'latent_dim': 64, 'hidden_dim': 208, 'beta': 1.872022181174179, 'sequence_len': 1, 'lr': 0.0006756515056065638}...
  [30/50] Testing {'latent_dim': 18, 'hidden_dim': 132, 'beta': 0.6257703289467376, 'sequence_len': 1, 'lr': 0.00028862272995490743}...
  [31/50] Testing {'latent_dim': 47, 'hidden_dim': 190, 'beta': 1.475345514842017, 'sequence_len': 1, 'lr': 0.0006214674039079927}...
  [32/50] Testing {'latent_dim': 60, 'hidden_dim': 225, 'beta': 0.7254377778308865, 'sequence_len': 5, 'lr': 0.00026637290737828835}...
  [33/50] Testing {'latent_dim': 52, 'hidden_dim': 152, 'beta': 1.3767531676203921, 'sequence_len': 5, 'lr': 0.0001466939874946583}...
  [34/50] Testing {'latent_dim': 38, 'hidden_dim': 67, 'beta': 1.213227894143513, 'sequence_len': 5, 'lr': 0.0005052810880485999}...
  [35/50] Testing {'latent_dim': 50, 'hidden_dim': 216, 'beta': 1.5496033830605807, 'sequence_len': 5, 'lr': 0.0004049581405500823}...
  [36/50] Testing {'latent_dim': 44, 'hidden_dim': 146, 'beta': 0.9865360328675468, 'sequence_len': 10, 'lr': 0.00010043410509783542}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x146)
  [37/50] Testing {'latent_dim': 42, 'hidden_dim': 203, 'beta': 1.470602739156478, 'sequence_len': 1, 'lr': 0.0007233134732021937}...
  [38/50] Testing {'latent_dim': 17, 'hidden_dim': 245, 'beta': 0.9688978168815181, 'sequence_len': 5, 'lr': 0.0001622845307460288}...
  [39/50] Testing {'latent_dim': 26, 'hidden_dim': 139, 'beta': 0.602321256131833, 'sequence_len': 10, 'lr': 0.00010088781725712776}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x139)
  [40/50] Testing {'latent_dim': 25, 'hidden_dim': 104, 'beta': 1.962436783189618, 'sequence_len': 1, 'lr': 0.00016015549834976783}...
  [41/50] Testing {'latent_dim': 41, 'hidden_dim': 66, 'beta': 1.686351678763674, 'sequence_len': 10, 'lr': 0.0009507459332395899}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x66)
  [42/50] Testing {'latent_dim': 41, 'hidden_dim': 240, 'beta': 1.6588278376299996, 'sequence_len': 1, 'lr': 0.00029968779068665345}...
  [43/50] Testing {'latent_dim': 35, 'hidden_dim': 179, 'beta': 1.1951108671375252, 'sequence_len': 10, 'lr': 0.00034850775694652837}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x179)
  [44/50] Testing {'latent_dim': 28, 'hidden_dim': 143, 'beta': 0.8162588458624755, 'sequence_len': 1, 'lr': 0.0007855242398679945}...
  [45/50] Testing {'latent_dim': 48, 'hidden_dim': 200, 'beta': 1.4745709473653208, 'sequence_len': 1, 'lr': 0.0005478519575938534}...
  [46/50] Testing {'latent_dim': 52, 'hidden_dim': 135, 'beta': 0.5392922967617573, 'sequence_len': 5, 'lr': 0.0004120555301022909}...
  [47/50] Testing {'latent_dim': 23, 'hidden_dim': 153, 'beta': 1.1662867132383348, 'sequence_len': 1, 'lr': 0.0005925485885463293}...
  [48/50] Testing {'latent_dim': 27, 'hidden_dim': 203, 'beta': 0.9008839957324026, 'sequence_len': 10, 'lr': 0.000344919591369973}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x203)
  [49/50] Testing {'latent_dim': 19, 'hidden_dim': 128, 'beta': 0.8505034645379983, 'sequence_len': 1, 'lr': 0.0008209352311058081}...
  [50/50] Testing {'latent_dim': 19, 'hidden_dim': 228, 'beta': 1.5362093765768745, 'sequence_len': 10, 'lr': 0.000169146978163049}...
    ✗ Failed: mat1 and mat2 shapes cannot be multiplied (512x52 and 102x228)

VAE Best Config: {'latent_dim': 21, 'hidden_dim': 110, 'beta': 0.6496334184010276, 'sequence_len': 5, 'lr': 0.0002106420361110957}
VAE Best Val Loss: 0.068870
VAE Train Time: 4.74s

============================================================
RANDOM SEARCH COMPLETE
============================================================
Linear       | Val Loss: 0.009308 | Time: 4.80s
             | Config: {'sequence_len': 5, 'lr': 0.0008079276950216151}
Transformer  | Val Loss: 0.000006 | Time: 10.71s
             | Config: {'d_model': 112, 'nhead': 8, 'num_layers': 2, 'dropout': 0.03882145336115335, 'sequence_len': 5, 'lr': 0.00014095462271185676}
Bayesian     | Val Loss: 0.035634 | Time: 2.42s
             | Config: {'hidden_dim': 184, 'prior_std': 0.559042263837664, 'kl_weight': 5.125126452371425e-05, 'sequence_len': 1, 'lr': 0.0003764330673533697}
VAE          | Val Loss: 0.068870 | Time: 4.74s
             | Config: {'latent_dim': 21, 'hidden_dim': 110, 'beta': 0.6496334184010276, 'sequence_len': 5, 'lr': 0.0002106420361110957}

============================================================
EVALUATING BEST MODELS FROM RANDOM SEARCH
============================================================

Evaluating Linear...
Linear - Success: 0.0%, Avg Reward: 4.84

Evaluating Transformer...
Transformer - Success: 0.0%, Avg Reward: -57.98

Evaluating Bayesian...
Bayesian - Success: 0.0%, Avg Reward: -61.12

Evaluating VAE...
VAE - Success: 0.0%, Avg Reward: -61.23

============================================================
EVALUATION COMPLETE
============================================================


================================================================================
FINAL RESULTS SUMMARY
================================================================================
  Algorithm  Val Loss  Train Time (s)  Success Rate  Avg Reward  Avg Steps
Transformer  0.000006       10.705369           0.0  -57.983146     115.94
     Linear  0.009308        4.795472           0.0    4.835561     200.00
   Bayesian  0.035634        2.417052           0.0  -61.117656      36.00
        VAE  0.068870        4.736609           0.0  -61.227920      32.06
================================================================================


================================================================================
FINAL RESULTS SUMMARY (Random Search)
================================================================================

Linear:
  Best Config: {'sequence_len': 5, 'lr': 0.0008079276950216151}
  Validation Loss: 0.009308
  Training Time: 4.80s
  Success Rate: 0.0%
  Avg Reward: 4.84
  Avg Steps: 200.0

Transformer:
  Best Config: {'d_model': 112, 'nhead': 8, 'num_layers': 2, 'dropout': 0.03882145336115335, 'sequence_len': 5, 'lr': 0.00014095462271185676}
  Validation Loss: 0.000006
  Training Time: 10.71s
  Success Rate: 0.0%
  Avg Reward: -57.98
  Avg Steps: 115.9

Bayesian:
  Best Config: {'hidden_dim': 184, 'prior_std': 0.559042263837664, 'kl_weight': 5.125126452371425e-05, 'sequence_len': 1, 'lr': 0.0003764330673533697}
  Validation Loss: 0.035634
  Training Time: 2.42s
  Success Rate: 0.0%
  Avg Reward: -61.12
  Avg Steps: 36.0

VAE:
  Best Config: {'latent_dim': 21, 'hidden_dim': 110, 'beta': 0.6496334184010276, 'sequence_len': 5, 'lr': 0.0002106420361110957}
  Validation Loss: 0.068870
  Training Time: 4.74s
  Success Rate: 0.0%
  Avg Reward: -61.23
  Avg Steps: 32.1
================================================================================

Note: Each algorithm tested 50 random configurations
Total configurations tested: 200